CREATE SCHEMA dw;

CREATE TABLE dw.dim_business_unit ( 
	business_unit_key    bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	bar_entity           varchar(20)    ENCODE lzo,
	bar_entity_description varchar(200)    ENCODE lzo,
	geography            varchar(100)    ENCODE lzo,
	region               varchar(30)    ENCODE lzo,
	subregion            varchar(30)    ENCODE lzo,
	start_date           date  NOT NULL  ENCODE az64,
	end_date             date  NOT NULL  ENCODE az64,
	audit_loadts         date  NOT NULL  ENCODE az64
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_currency ( 
	currency_cd          varchar(20)  NOT NULL  ENCODE lzo,
	currency_format      varchar(20)    ENCODE lzo,
	currency_sort        integer    ENCODE az64
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_customer ( 
	customer_key         bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	customer_id          varchar(200)    ENCODE lzo,
	soldto_number        varchar(50)    ENCODE lzo,
	shipto_number        varchar(50)    ENCODE lzo,
	soldto_name          varchar(100)    ENCODE lzo,
	shipto_name          varchar(100)    ENCODE lzo,
	base_customer        varchar(50)    ENCODE lzo,
	base_customer_desc   varchar(100)    ENCODE lzo,
	level01_bar          varchar(100)    ENCODE lzo,
	level02_bar          varchar(100)    ENCODE lzo,
	level03_bar          varchar(100)    ENCODE lzo,
	level04_bar          varchar(100)    ENCODE lzo,
	level05_bar          varchar(100)    ENCODE lzo,
	level06_bar          varchar(100)    ENCODE lzo,
	level07_bar          varchar(100)    ENCODE lzo,
	level08_bar          varchar(100)    ENCODE lzo,
	level09_bar          varchar(100)    ENCODE lzo,
	level10_bar          varchar(100)    ENCODE lzo,
	level11_bar          varchar(100)    ENCODE lzo,
	membertype           varchar(10)    ENCODE lzo,
	generation           integer    ENCODE az64,
	ragged_level01_bar   varchar(100)    ENCODE lzo,
	ragged_level02_bar   varchar(100)    ENCODE lzo,
	ragged_level03_bar   varchar(100)    ENCODE lzo,
	ragged_level04_bar   varchar(100)    ENCODE lzo,
	ragged_level05_bar   varchar(100)    ENCODE lzo,
	ragged_level06_bar   varchar(100)    ENCODE lzo,
	ragged_level07_bar   varchar(100)    ENCODE lzo,
	ragged_level08_bar   varchar(100)    ENCODE lzo,
	ragged_level09_bar   varchar(100)    ENCODE lzo,
	ragged_level10_bar   varchar(100)    ENCODE lzo,
	ragged_level11_bar   varchar(100)    ENCODE lzo,
	demand_group         varchar(100)    ENCODE lzo,
	a2                   varchar(100)    ENCODE lzo,
	a1                   varchar(100)    ENCODE lzo,
	a2_desc              varchar(100)    ENCODE lzo,
	a1_desc              varchar(100)    ENCODE lzo,
	start_date           date  NOT NULL  ENCODE az64,
	end_date             date  NOT NULL  ENCODE az64,
	audit_loadts         timestamp  NOT NULL  ENCODE az64,
	level01_commercial   varchar(100)    ENCODE lzo,
	level02_commercial   varchar(100)    ENCODE lzo,
	level03_commercial   varchar(100)    ENCODE lzo,
	level04_commercial   varchar(100)    ENCODE lzo,
	level05_commercial   varchar(100)    ENCODE lzo,
	level06_commercial   varchar(100)    ENCODE lzo,
	hierarchy_b_id       varchar(100)    ENCODE lzo,
	hierarchy_b_desc     varchar(100)    ENCODE lzo,
	hierarchy_c_id       varchar(100)    ENCODE lzo,
	hierarchy_c_desc     varchar(100)    ENCODE lzo
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_customer_restatement ( 
	soldto_number        varchar(50)    ENCODE lzo,
	base_customer        varchar(50)    ENCODE lzo,
	base_customer_desc   varchar(100)    ENCODE lzo,
	level01_bar          varchar(100)    ENCODE lzo,
	level02_bar          varchar(100)    ENCODE lzo,
	level03_bar          varchar(100)    ENCODE lzo,
	level04_bar          varchar(100)    ENCODE lzo,
	level05_bar          varchar(100)    ENCODE lzo,
	level06_bar          varchar(100)    ENCODE lzo,
	level07_bar          varchar(100)    ENCODE lzo,
	level08_bar          varchar(100)    ENCODE lzo,
	level09_bar          varchar(100)    ENCODE lzo,
	level10_bar          varchar(100)    ENCODE lzo,
	level11_bar          varchar(100)    ENCODE lzo,
	demand_group         varchar(100)    ENCODE lzo,
	a2                   varchar(100)    ENCODE lzo,
	a1                   varchar(100)    ENCODE lzo,
	a2_desc              varchar(100)    ENCODE lzo,
	a1_desc              varchar(100)    ENCODE lzo,
	level01_commercial   varchar(100)    ENCODE lzo,
	level02_commercial   varchar(100)    ENCODE lzo,
	level03_commercial   varchar(100)    ENCODE lzo,
	level04_commercial   varchar(100)    ENCODE lzo,
	level05_commercial   varchar(100)    ENCODE lzo,
	level06_commercial   varchar(100)    ENCODE lzo,
	hierarchy_b_id       varchar(100)    ENCODE lzo,
	hierarchy_b_desc     varchar(100)    ENCODE lzo,
	hierarchy_c_id       varchar(100)    ENCODE lzo,
	hierarchy_c_desc     varchar(100)    ENCODE lzo
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_dataprocessing_outcome ( 
	dataprocessing_outcome_key bigint    ENCODE az64,
	dataprocessing_outcome_id integer    ENCODE az64,
	dataprocessing_outcome_desc varchar(200)    ENCODE lzo,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	start_date           date    ENCODE az64,
	end_date             date    ENCODE az64,
	audit_loadts         timestamp    ENCODE az64
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_dataprocessing_rule ( 
	data_processing_ruleid integer  NOT NULL  ENCODE az64,
	soldtoflag           varchar(1)    ENCODE lzo,
	skuflag              varchar(1)    ENCODE lzo,
	barcustflag          varchar(1)    ENCODE lzo,
	barproductflag       varchar(1)    ENCODE lzo,
	barbrandflag         varchar(1)    ENCODE lzo,
	dataprocessing_group varchar(200)    ENCODE lzo,
	dataprocessing_rule_description varchar(400)    ENCODE lzo,
	dataprocessing_rule_steps varchar(500)    ENCODE lzo,
	audit_loadts         date  NOT NULL  ENCODE az64
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_date ( 
	dy_id                integer    ENCODE az64,
	dy_dte               timestamp    ENCODE az64,
	absolute_dy_nbr      integer    ENCODE az64,
	absolute_wk_nbr      integer    ENCODE az64,
	absolute_mth_nbr     integer    ENCODE az64,
	absolute_qtr_nbr     integer    ENCODE az64,
	dy_in_wk_nbr         integer    ENCODE az64,
	dy_in_wk_name        varchar(200)    ENCODE lzo,
	julian_dy_nbr        integer    ENCODE az64,
	clndr_wk_nbr         varchar(200)    ENCODE lzo,
	clndr_wk_id          varchar(200)    ENCODE lzo,
	clndr_mth_nbr        integer    ENCODE az64,
	clndr_mth_id         varchar(200)    ENCODE lzo,
	clndr_mth_name       varchar(200)    ENCODE lzo,
	clndr_qtr_nbr        integer    ENCODE az64,
	clndr_qtr_id         varchar(200)    ENCODE lzo,
	clndr_qtr_name       varchar(200)    ENCODE lzo,
	clndr_yr_id          integer    ENCODE az64,
	clndr_dy_in_mth_nbr  integer    ENCODE az64,
	is_first_dy_in_clndr_mth_flag varchar(1)    ENCODE lzo,
	is_last_dy_in_clndr_mth_flag varchar(1)    ENCODE lzo,
	wk_begin_dte         timestamp    ENCODE az64,
	wk_end_dte           timestamp    ENCODE az64,
	fmth_begin_dte       timestamp    ENCODE az64,
	fmth_end_dte         timestamp    ENCODE az64,
	fqtr_begin_dte       timestamp    ENCODE az64,
	fqtr_end_dte         timestamp    ENCODE az64,
	fyr_begin_dte        timestamp    ENCODE az64,
	fyr_end_dte          timestamp    ENCODE az64,
	fwk_nbr              integer    ENCODE az64,
	fwk_id               integer    ENCODE az64,
	fwk_cd               varchar(200)    ENCODE lzo,
	fmth_nbr             integer    ENCODE az64,
	fmth_id              integer    ENCODE az64,
	fmth_cd              varchar(200)    ENCODE lzo,
	fmth_name            varchar(200)    ENCODE lzo,
	fmth_short_name      varchar(200)    ENCODE lzo,
	fqtr_nbr             integer    ENCODE az64,
	fqtr_id              integer    ENCODE az64,
	fqtr_cd              varchar(200)    ENCODE lzo,
	fqtr_name            varchar(200)    ENCODE lzo,
	fyr_id               integer    ENCODE az64,
	fdy_in_mth_nbr       integer    ENCODE az64,
	fscl_days_remaining_in_mth integer    ENCODE az64,
	fdy_in_qtr_nbr       integer    ENCODE az64,
	fscl_days_remaining_in_qtr integer    ENCODE az64,
	fdy_in_yr_nbr        integer    ENCODE az64,
	fscl_days_remaining_in_yr integer    ENCODE az64,
	fwk_in_mth_nbr       integer    ENCODE az64,
	fwk_in_qtr           integer    ENCODE az64,
	is_wk_dy_flag        varchar(1)    ENCODE lzo,
	is_weekend_flag      varchar(1)    ENCODE lzo,
	is_first_dy_of_fwk_flag varchar(1)    ENCODE lzo,
	is_last_dy_of_fwk_flag varchar(1)    ENCODE lzo,
	is_first_dy_of_fmth_flag varchar(1)    ENCODE lzo,
	is_last_dy_of_fmth_flag varchar(1)    ENCODE lzo,
	is_first_dy_of_fqtr_flag varchar(1)    ENCODE lzo,
	is_last_dy_of_fqtr_flag varchar(1)    ENCODE lzo,
	is_first_dy_of_fyr_flag varchar(1)    ENCODE lzo,
	is_last_dy_of_fyr_flag varchar(1)    ENCODE lzo,
	season_name          varchar(200)    ENCODE lzo,
	holiday_name         varchar(200)    ENCODE lzo,
	holiday_season_name  varchar(200)    ENCODE lzo,
	holiday_observed_name varchar(200)    ENCODE lzo,
	special_event_name   varchar(200)    ENCODE lzo
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_product ( 
	product_key          bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	product_id           varchar(200)    ENCODE lzo,
	material             varchar(100)    ENCODE lzo,
	bar_product          varchar(100)    ENCODE lzo,
	sku                  varchar(200)    ENCODE lzo,
	product_brand        varchar(100)    ENCODE lzo,
	portfolio            varchar(100)    ENCODE lzo,
	portfolio_desc       varchar(200)    ENCODE lzo,
	member_type          varchar(50)    ENCODE lzo,
	generation           integer    ENCODE az64,
	level01_bar          varchar(100)    ENCODE lzo,
	level02_bar          varchar(100)    ENCODE lzo,
	level03_bar          varchar(100)    ENCODE lzo,
	level04_bar          varchar(100)    ENCODE lzo,
	level05_bar          varchar(100)    ENCODE lzo,
	level06_bar          varchar(100)    ENCODE lzo,
	level07_bar          varchar(100)    ENCODE lzo,
	level08_bar          varchar(100)    ENCODE lzo,
	level09_bar          varchar(100)    ENCODE lzo,
	start_date           date  NOT NULL  ENCODE az64,
	end_date             date  NOT NULL  ENCODE az64,
	audit_loadts         timestamp  NOT NULL  ENCODE az64,
	gpp_division_code    varchar(10)    ENCODE lzo,
	prd_comm_level01_gts varchar(100)    ENCODE lzo,
	prd_comm_level02_super_bu varchar(100)    ENCODE lzo,
	prd_comm_level03_subcategory varchar(100)    ENCODE lzo,
	prd_comm_level04_category varchar(100)    ENCODE lzo,
	prd_comm_level05_gpp_portfolio varchar(100)    ENCODE lzo
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_product_restatement ( 
	material_key         bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	material             varchar(30)  NOT NULL  ENCODE lzo,
	portfolio            varchar(100)  NOT NULL  ENCODE lzo,
	portfolio_desc       varchar(200)    ENCODE lzo,
	bar_product          varchar(100)    ENCODE lzo,
	bar_product_desc     varchar(200)    ENCODE lzo,
	member_type          varchar(50)    ENCODE lzo,
	generation           integer    ENCODE az64,
	level01_bar          varchar(100)    ENCODE lzo,
	level02_bar          varchar(100)    ENCODE lzo,
	level03_bar          varchar(100)    ENCODE lzo,
	level04_bar          varchar(100)    ENCODE lzo,
	level05_bar          varchar(100)    ENCODE lzo,
	level06_bar          varchar(100)    ENCODE lzo,
	level07_bar          varchar(100)    ENCODE lzo,
	level08_bar          varchar(100)    ENCODE lzo,
	level09_bar          varchar(100)    ENCODE lzo,
	start_date           date  NOT NULL  ENCODE az64,
	end_date             date  NOT NULL  ENCODE az64,
	audit_loadts         timestamp  NOT NULL  ENCODE az64
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_scenario ( 
	scenario_id          integer  NOT NULL  ENCODE az64,
	scenario             varchar(20)    ENCODE lzo
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_source_system ( 
	source_system_id     integer    ENCODE az64,
	source_system        varchar(20)    ENCODE lzo
 )   DISTSTYLE ALL;

CREATE TABLE dw.dim_transactional_attributes ( 
	dim_transactional_attributes_id varchar(300)  NOT NULL  ENCODE lzo,
	pcr                  varchar(300)  NOT NULL  ENCODE lzo
 )   DISTSTYLE ALL;

CREATE TABLE dw.fact_pnl_commercial ( 
	fact_pnl_commercial_id bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	org_tranagg_id       bigint    ENCODE az64,
	org_dataprocessing_ruleid integer    ENCODE az64,
	mapped_dataprocessing_ruleid integer    ENCODE az64,
	dataprocessing_outcome_key integer    ENCODE az64,
	bar_acct             varchar(6)    ENCODE lzo,
	bar_currtype         varchar(6)    ENCODE lzo,
	posting_week_enddate date    ENCODE RAW,
	fiscal_month_id      integer    ENCODE az64,
	scenario_id          integer    ENCODE az64,
	source_system_id     integer    ENCODE az64,
	business_unit_key    bigint    ENCODE az64,
	customer_key         bigint    ENCODE az64,
	product_key          bigint    ENCODE az64,
	org_bar_custno       varchar(30)    ENCODE lzo,
	org_bar_product      varchar(30)    ENCODE lzo,
	org_bar_brand        varchar(30)    ENCODE lzo,
	mapped_bar_custno    varchar(30)    ENCODE lzo,
	mapped_bar_product   varchar(30)    ENCODE lzo,
	mapped_bar_brand     varchar(30)    ENCODE lzo,
	org_soldtocust       varchar(30)    ENCODE lzo,
	org_shiptocust       varchar(30)    ENCODE lzo,
	org_material         varchar(30)    ENCODE lzo,
	alloc_soldtocust     varchar(30)    ENCODE lzo,
	alloc_shiptocust     varchar(30)    ENCODE lzo,
	alloc_material       varchar(30)    ENCODE lzo,
	alloc_bar_product    varchar(30)    ENCODE lzo,
	amt                  decimal(38,8)    ENCODE az64,
	tran_volume          decimal(19,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	uom                  varchar(15)    ENCODE lzo,
	sales_invoiced       decimal(38,8)    ENCODE az64,
	sales_freight_income decimal(38,8)    ENCODE az64,
	product_sales_export decimal(38,8)    ENCODE az64,
	product_sales_domenstic_total decimal(38,8)    ENCODE az64,
	fob_invoice_sale     decimal(38,8)    ENCODE az64,
	rental_sales         decimal(38,8)    ENCODE az64,
	destroy_in_field     decimal(38,8)    ENCODE az64,
	product_sales        decimal(38,8)    ENCODE az64,
	billable_service_revenue decimal(38,8)    ENCODE az64,
	contract_service_revenue decimal(38,8)    ENCODE az64,
	install_revenue      decimal(38,8)    ENCODE az64,
	service_and_installation_sales decimal(38,8)    ENCODE az64,
	franchise_revenue    decimal(38,8)    ENCODE az64,
	royalty_revenue      decimal(38,8)    ENCODE az64,
	other_sales_revenue_total decimal(38,8)    ENCODE az64,
	returns_domestic     decimal(38,8)    ENCODE az64,
	returns_export       decimal(38,8)    ENCODE az64,
	sales_returns        decimal(38,8)    ENCODE az64,
	rsa_and_price_adjustments decimal(38,8)    ENCODE az64,
	allowances_total     decimal(38,8)    ENCODE az64,
	rebates              decimal(38,8)    ENCODE az64,
	coop_advertising     decimal(38,8)    ENCODE az64,
	cashdiscount_domestic decimal(38,8)    ENCODE az64,
	cashdiscount_export  decimal(38,8)    ENCODE az64,
	cash_discount_total  decimal(38,8)    ENCODE az64,
	fillrate_fine        decimal(38,8)    ENCODE az64,
	fob_deductions       decimal(38,8)    ENCODE az64,
	discounts_allow_domestic decimal(38,8)    ENCODE az64,
	discounts_allow_export decimal(38,8)    ENCODE az64,
	discounts_and_allowexcl_coop_adv decimal(38,8)    ENCODE az64,
	freight_domestic     decimal(38,8)    ENCODE az64,
	freight_export       decimal(38,8)    ENCODE az64,
	sales_freight        decimal(38,8)    ENCODE az64,
	customer_considerations decimal(38,8)    ENCODE az64,
	sales_adjustments_other decimal(38,8)    ENCODE az64,
	sales_deduction_other decimal(38,8)    ENCODE az64,
	standard_material_cost_domestic decimal(38,8)    ENCODE az64,
	standard_material_cost_fob decimal(38,8)    ENCODE az64,
	standard_material_cost_export decimal(38,8)    ENCODE az64,
	standard_material_cost_serv_install decimal(38,8)    ENCODE az64,
	standard_material_cost_serv_install_3p decimal(38,8)    ENCODE az64,
	standard_material_cost decimal(38,8)    ENCODE az64,
	cos_trd_domestic_labor decimal(38,8)    ENCODE az64,
	cos_trd_export_labor decimal(38,8)    ENCODE az64,
	std_labor_cost_manuf decimal(38,8)    ENCODE az64,
	cos_service          decimal(38,8)    ENCODE az64,
	cos_monitoring       decimal(38,8)    ENCODE az64,
	cos_installations    decimal(38,8)    ENCODE az64,
	std_labor_cos_serv_install decimal(38,8)    ENCODE az64,
	std_labor_cos_serv_install_3p decimal(38,8)    ENCODE az64,
	std_labor_cos        decimal(38,8)    ENCODE az64,
	std_oh_cos_serv_install decimal(38,8)    ENCODE az64,
	std_oh_cos_serv_install_3p decimal(38,8)    ENCODE az64,
	std_oh_cos_export    decimal(38,8)    ENCODE az64,
	std_oh_cos           decimal(38,8)    ENCODE az64,
	free_goods_cos       decimal(38,8)    ENCODE az64,
	targeted_funds_cos   decimal(38,8)    ENCODE az64,
	free_goods_total     decimal(38,8)    ENCODE az64,
	cos_freight_outbound decimal(38,8)    ENCODE az64,
	merchandising_cos    decimal(38,8)    ENCODE az64,
	rental_cos           decimal(38,8)    ENCODE az64,
	gross_sales          decimal(38,8)    ENCODE az64,
	allowances           decimal(38,8)    ENCODE az64,
	invoice_sales        decimal(38,8)    ENCODE az64,
	sales_deduction      decimal(38,8)    ENCODE az64,
	net_sales            decimal(38,8)    ENCODE az64,
	std_cos              decimal(38,8)    ENCODE az64,
	total_cos            decimal(38,8)    ENCODE az64,
	std_gross_margin     decimal(38,8)    ENCODE az64,
	audit_loadts         date  NOT NULL  ENCODE az64,
	dim_transactional_attributes_id varchar(300)    ENCODE lzo
 ) DISTKEY (customer_key) SORTKEY (posting_week_enddate) DISTSTYLE KEY;

CREATE TABLE dw.fact_pnl_commercial_orig ( 
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date    ENCODE az64,
	fiscal_month_id      integer    ENCODE az64,
	bar_currtype         varchar(6)    ENCODE lzo,
	amt                  decimal(38,8)    ENCODE az64,
	amt_usd              decimal(38,8)    ENCODE az64,
	tran_volume          decimal(19,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	uom                  varchar(10)    ENCODE lzo
 )   DISTSTYLE AUTO;

CREATE TABLE dw.fact_pnl_commercial_stacked ( 
	fact_pnl_commercial_stacked_id bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	org_tranagg_id       bigint    ENCODE az64,
	org_dataprocessing_ruleid integer    ENCODE az64,
	mapped_dataprocessing_ruleid integer    ENCODE az64,
	dataprocessing_outcome_key integer    ENCODE az64,
	bar_acct             varchar(6)    ENCODE lzo,
	bar_currtype         varchar(6)    ENCODE lzo,
	posting_week_enddate date    ENCODE RAW,
	fiscal_month_id      integer    ENCODE az64,
	scenario_id          integer    ENCODE az64,
	source_system_id     integer    ENCODE az64,
	business_unit_key    bigint    ENCODE az64,
	customer_key         bigint    ENCODE az64,
	product_key          bigint    ENCODE az64,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	allocated_flag       boolean    ENCODE RAW,
	amt                  decimal(38,8)    ENCODE az64,
	amt_usd              decimal(38,8)    ENCODE az64,
	tran_volume          decimal(19,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	uom                  varchar(10)    ENCODE lzo,
	dim_transactional_attributes_id varchar(300)    ENCODE lzo
 ) DISTKEY (product_key) SORTKEY (posting_week_enddate) DISTSTYLE KEY;

CREATE TABLE dw.fact_pnl_ocos ( 
	fact_pnl_ocos_id     bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	org_tranagg_id       bigint    ENCODE az64,
	dataprocessing_ruleid integer    ENCODE az64,
	dataprocessing_outcome_key integer    ENCODE az64,
	bar_acct             varchar(30)    ENCODE lzo,
	bar_currtype         varchar(6)    ENCODE lzo,
	posting_week_enddate date    ENCODE RAW,
	fiscal_month_id      integer    ENCODE az64,
	scenario_id          integer    ENCODE az64,
	source_system_id     integer    ENCODE az64,
	business_unit_key    bigint    ENCODE az64,
	customer_key         bigint    ENCODE az64,
	product_key          bigint    ENCODE az64,
	soldtocust           varchar(30)    ENCODE lzo,
	shiptocust           varchar(30)    ENCODE lzo,
	bar_custno           varchar(30)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	bar_product          varchar(30)    ENCODE lzo,
	bar_brand            varchar(30)    ENCODE lzo,
	cost_pool            varchar(10)    ENCODE lzo,
	super_sbu            varchar(100)    ENCODE lzo,
	amt                  decimal(38,8)    ENCODE az64,
	amt_usd              decimal(38,8)    ENCODE az64,
	reported_inventory_adjustment decimal(38,8)    ENCODE az64,
	reported_warranty_cost decimal(38,8)    ENCODE az64,
	reported_duty_tariffs decimal(38,8)    ENCODE az64,
	reported_freight     decimal(38,8)    ENCODE az64,
	reported_ppv         decimal(38,8)    ENCODE az64,
	reported_labor_overhead decimal(38,8)    ENCODE az64,
	tran_volume          decimal(19,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	uom                  varchar(10)    ENCODE lzo,
	audit_loadts         date  NOT NULL  ENCODE az64
 ) DISTKEY (customer_key) SORTKEY (posting_week_enddate) DISTSTYLE KEY;

CREATE TABLE dw.fact_pnl_ocos_stacked ( 
	fact_pnl_ocos_stacked_id bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	org_tranagg_id       bigint    ENCODE az64,
	dataprocessing_ruleid integer    ENCODE az64,
	dataprocessing_outcome_key integer    ENCODE az64,
	bar_acct             varchar(30)    ENCODE lzo,
	bar_currtype         varchar(6)    ENCODE lzo,
	posting_week_enddate date    ENCODE RAW,
	fiscal_month_id      integer    ENCODE az64,
	scenario_id          integer    ENCODE az64,
	source_system_id     integer    ENCODE az64,
	business_unit_key    bigint    ENCODE az64,
	customer_key         bigint    ENCODE az64,
	product_key          bigint    ENCODE az64,
	soldtocust           varchar(30)    ENCODE lzo,
	shiptocust           varchar(30)    ENCODE lzo,
	bar_custno           varchar(30)    ENCODE lzo,
	cost_pool            varchar(10)    ENCODE lzo,
	super_sbu            varchar(100)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	bar_product          varchar(30)    ENCODE lzo,
	bar_brand            varchar(30)    ENCODE lzo,
	amt                  decimal(38,8)    ENCODE az64,
	amt_usd              decimal(38,8)    ENCODE az64,
	tran_volume          decimal(19,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	uom                  varchar(10)    ENCODE lzo
 ) DISTKEY (customer_key) SORTKEY (posting_week_enddate) DISTSTYLE KEY;
