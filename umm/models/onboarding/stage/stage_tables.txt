CREATE SCHEMA stage;

CREATE TABLE stage.agm_1070_costing ( 
	matnr                varchar(65535)    ENCODE lzo,
	fiscal_month_id      integer    ENCODE az64,
	avg_standard_tot_matl decimal(38,17)    ENCODE az64,
	avg_standard_fgt_abs decimal(38,17)    ENCODE az64,
	avg_standard_duty    decimal(38,17)    ENCODE az64,
	avg_current_tot_matl decimal(38,17)    ENCODE az64,
	avg_current_fgt_abs  decimal(38,17)    ENCODE az64,
	avg_current_duty     decimal(38,17)    ENCODE az64,
	avg_standard_pp      decimal(38,17)    ENCODE az64,
	avg_current_pp       decimal(38,17)    ENCODE az64,
	avg_fgt_abs_var      decimal(38,17)    ENCODE az64,
	avg_duty_var         decimal(38,17)    ENCODE az64,
	avg_ppv_var          decimal(38,17)    ENCODE az64
 ) DISTKEY (matnr)  DISTSTYLE KEY;

CREATE TABLE stage.agm_1070_costing_base ( 
	matnr                varchar(65535)    ENCODE RAW,
	plant                varchar(65535)    ENCODE RAW,
	st_fromdate          date    ENCODE az64,
	st_todate            date    ENCODE az64,
	from_currtype        varchar(10)    ENCODE lzo,
	standard_tot_matl    decimal(38,17)    ENCODE az64,
	standard_fgt_abs     decimal(38,17)    ENCODE az64,
	standard_duty        decimal(38,17)    ENCODE az64,
	cc_fromdate          date    ENCODE az64,
	cc_todate            date    ENCODE az64,
	current_tot_matl     decimal(38,17)    ENCODE az64,
	current_fgt_abs      decimal(38,17)    ENCODE az64,
	current_duty         decimal(38,17)    ENCODE az64,
	standard_pp          decimal(38,17)    ENCODE az64,
	current_pp           decimal(38,17)    ENCODE az64,
	fgt_abs_var          decimal(38,17)    ENCODE az64,
	duty_var             decimal(38,17)    ENCODE az64,
	ppv_var              decimal(38,17)    ENCODE az64,
	fiscal_month_id      integer    ENCODE az64
 )  SORTKEY (matnr, plant) DISTSTYLE EVEN;

CREATE TABLE stage.agm_allocated_data_cost_variance ( 
	acct_category        varchar(40)    ENCODE lzo,
	super_sbu            varchar(65535)    ENCODE lzo,
	alloc_amt            decimal(38,16)    ENCODE az64,
	material             varchar(30)    ENCODE lzo,
	soldtocust           varchar(10)    ENCODE lzo
 )   DISTSTYLE EVEN;

CREATE TABLE stage.agm_allocated_data_rule_100 ( 
	source_system        varchar(40)    ENCODE lzo,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(30)    ENCODE lzo,
	material             varchar(50)    ENCODE lzo,
	bar_product          varchar(50)    ENCODE lzo,
	bar_brand            varchar(50)    ENCODE lzo,
	soldtocust           varchar(50)    ENCODE lzo,
	shiptocust           varchar(50)    ENCODE lzo,
	bar_custno           varchar(50)    ENCODE lzo,
	cost_pool            varchar(10)    ENCODE lzo,
	super_sbu            varchar(100)    ENCODE lzo,
	dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	allocated_amt_usd    decimal(38,8)    ENCODE az64,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.agm_allocated_data_rule_101 ( 
	source_system        varchar(40)    ENCODE lzo,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(30)    ENCODE lzo,
	material             varchar(50)    ENCODE lzo,
	bar_product          varchar(50)    ENCODE lzo,
	bar_brand            varchar(50)    ENCODE lzo,
	soldtocust           varchar(50)    ENCODE lzo,
	shiptocust           varchar(50)    ENCODE lzo,
	bar_custno           varchar(50)    ENCODE lzo,
	dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	super_sbu            varchar(50)    ENCODE lzo,
	cost_pool            varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	allocated_amt_usd    decimal(38,8)    ENCODE az64,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 ) DISTKEY (material)  DISTSTYLE KEY;

CREATE TABLE stage.agm_allocated_data_rule_102_104 ( 
	source_system        varchar(40)    ENCODE lzo,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(30)    ENCODE lzo,
	material             varchar(50)    ENCODE lzo,
	bar_product          varchar(50)    ENCODE lzo,
	bar_brand            varchar(50)    ENCODE lzo,
	soldtocust           varchar(50)    ENCODE lzo,
	shiptocust           varchar(50)    ENCODE lzo,
	bar_custno           varchar(50)    ENCODE lzo,
	cost_pool            varchar(10)    ENCODE lzo,
	super_sbu            varchar(100)    ENCODE lzo,
	dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	allocated_amt_usd    decimal(38,8)    ENCODE az64,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.agm_allocated_data_rule_105 ( 
	source_system        varchar(40)    ENCODE lzo,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(30)    ENCODE lzo,
	material             varchar(50)    ENCODE lzo,
	bar_product          varchar(50)    ENCODE lzo,
	bar_brand            varchar(50)    ENCODE lzo,
	soldtocust           varchar(50)    ENCODE lzo,
	shiptocust           varchar(50)    ENCODE lzo,
	bar_custno           varchar(50)    ENCODE lzo,
	cost_pool            varchar(10)    ENCODE lzo,
	super_sbu            varchar(100)    ENCODE lzo,
	dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	allocated_amt_usd    decimal(38,8)    ENCODE az64,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.agm_cost_variance_gap_bods_trans_transient ( 
	super_sbu            varchar(100)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	acct_category        varchar(40)    ENCODE lzo,
	amt_usd              decimal(38,18)    ENCODE az64
 )   DISTSTYLE EVEN;

CREATE TABLE stage.agm_cost_variance_gap_final_gap_transient ( 
	acct_category        varchar(40)    ENCODE lzo,
	super_sbu            varchar(100)    ENCODE lzo,
	bar_cost             decimal(38,9)    ENCODE az64,
	calc_cost            decimal(38,8)    ENCODE az64,
	bar_bods             decimal(20,8)    ENCODE az64,
	prcnt_of_gap         decimal(38,4)    ENCODE az64,
	gap_to_alloc         decimal(38,12)    ENCODE az64
 ) DISTKEY (acct_category)  DISTSTYLE KEY;

CREATE TABLE stage.agm_costing_variance ( 
	sku_match            integer    ENCODE az64,
	fiscal_month_id      integer    ENCODE az64,
	posting_week_enddate date    ENCODE az64,
	material             varchar(50)    ENCODE lzo,
	super_sbu            varchar(65535)    ENCODE lzo,
	total_qty            decimal(38,8)    ENCODE az64,
	ppv_var              decimal(38,22)    ENCODE az64,
	duty_var             decimal(38,22)    ENCODE az64,
	frght_var            decimal(38,22)    ENCODE az64
 ) DISTKEY (material)  DISTSTYLE KEY;

CREATE TABLE stage.bods_core_transaction_agg ( 
	org_tranagg_id       bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	audit_rec_src        varchar(10)  NOT NULL  ENCODE lzo,
	bar_year             varchar(4)  NOT NULL  ENCODE lzo,
	bar_period           varchar(10)  NOT NULL  ENCODE lzo,
	bar_entity           varchar(5)  NOT NULL  ENCODE lzo,
	bar_acct             varchar(6)  NOT NULL  ENCODE lzo,
	shiptocust           varchar(10)    ENCODE lzo,
	soldtocust           varchar(10)    ENCODE lzo,
	org_bar_custno       varchar(20)    ENCODE lzo,
	mapped_bar_custno    varchar(20)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	org_bar_product      varchar(22)    ENCODE lzo,
	mapped_bar_product   varchar(22)    ENCODE lzo,
	org_bar_brand        varchar(22)    ENCODE lzo,
	mapped_bar_brand     varchar(22)    ENCODE lzo,
	bar_amt              decimal(38,8)  NOT NULL  ENCODE az64,
	bar_currtype         varchar(10)  NOT NULL  ENCODE lzo,
	sales_volume         decimal(38,8)  NOT NULL  ENCODE az64,
	tran_volume          decimal(38,8)  NOT NULL  ENCODE az64,
	uom                  varchar(20)    ENCODE lzo,
	posting_week_enddate date  NOT NULL  ENCODE RAW,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 ) DISTKEY (org_tranagg_id) SORTKEY (posting_week_enddate) DISTSTYLE KEY;

CREATE TABLE stage.bods_core_transaction_agg_agm ( 
	org_tranagg_agm_id   bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	audit_rec_src        varchar(10)  NOT NULL  ENCODE lzo,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE RAW,
	bar_entity           varchar(5)  NOT NULL  ENCODE lzo,
	bar_acct_category    varchar(50)    ENCODE lzo,
	bar_acct             varchar(10)  NOT NULL  ENCODE lzo,
	shiptocust           varchar(50)    ENCODE lzo,
	soldtocust           varchar(50)    ENCODE lzo,
	bar_custno           varchar(50)    ENCODE lzo,
	material             varchar(50)    ENCODE lzo,
	bar_product          varchar(50)    ENCODE lzo,
	bar_brand            varchar(50)    ENCODE lzo,
	bar_amt              decimal(38,8)  NOT NULL  ENCODE az64,
	bar_amt_usd          decimal(38,8)  NOT NULL  ENCODE az64,
	bar_currtype         varchar(10)  NOT NULL  ENCODE lzo,
	tran_volume          decimal(38,8)  NOT NULL  ENCODE az64,
	uom                  varchar(20)    ENCODE lzo,
	dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 ) DISTKEY (org_tranagg_agm_id) SORTKEY (posting_week_enddate) DISTSTYLE KEY;

CREATE TABLE stage.core_tran_delta ( 
	audit_rec_src        varchar(10)    ENCODE lzo,
	document_no          varchar(30)    ENCODE lzo,
	document_line        varchar(30)    ENCODE lzo,
	bar_year             varchar(4)    ENCODE lzo,
	bar_period           varchar(10)    ENCODE lzo,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	shiptocust           varchar(10)    ENCODE lzo,
	soldtocust           varchar(10)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	bar_custno           varchar(20)    ENCODE lzo,
	bar_product          varchar(22)    ENCODE lzo,
	bar_brand            varchar(22)    ENCODE lzo,
	bar_currtype         varchar(10)    ENCODE lzo,
	postdate             date    ENCODE az64,
	posting_week_enddate date    ENCODE RAW,
	fiscal_month_id      integer    ENCODE az64,
	bar_amt              decimal(38,8)    ENCODE az64,
	quantity             decimal(38,8)    ENCODE az64,
	quanunit             varchar(10)    ENCODE lzo,
	dataprocessing_hash  varchar(40)    ENCODE lzo,
	audit_loadts         timestamp    ENCODE az64
 ) DISTKEY (material) SORTKEY (posting_week_enddate) DISTSTYLE KEY;

CREATE TABLE stage.core_tran_delta_agm ( 
	audit_rec_src        varchar(10)    ENCODE lzo,
	document_no          varchar(10)    ENCODE lzo,
	document_line        varchar(3)    ENCODE lzo,
	bar_year             varchar(4)    ENCODE lzo,
	bar_period           varchar(10)    ENCODE lzo,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(10)    ENCODE lzo,
	shiptocust           varchar(10)    ENCODE lzo,
	soldtocust           varchar(10)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	bar_custno           varchar(20)    ENCODE lzo,
	bar_product          varchar(22)    ENCODE lzo,
	bar_brand            varchar(14)    ENCODE lzo,
	bar_currtype         varchar(10)    ENCODE lzo,
	postdate             date    ENCODE az64,
	posting_week_enddate date    ENCODE RAW,
	fiscal_month_id      integer    ENCODE az64,
	bar_amt              decimal(38,8)    ENCODE az64,
	quantity             decimal(38,8)    ENCODE az64,
	quanunit             varchar(10)    ENCODE lzo,
	dataprocessing_hash  varchar(40)    ENCODE lzo,
	audit_loadts         timestamp    ENCODE az64
 ) DISTKEY (material) SORTKEY (posting_week_enddate) DISTSTYLE KEY;

CREATE TABLE stage.core_tran_delta_cleansed ( 
	audit_rec_src        varchar(10)    ENCODE lzo,
	document_no          varchar(30)    ENCODE lzo,
	document_line        varchar(30)    ENCODE lzo,
	bar_year             varchar(4)    ENCODE lzo,
	bar_period           varchar(10)    ENCODE lzo,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	shiptocust           varchar(10)    ENCODE lzo,
	soldtocust           varchar(10)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	org_bar_custno       varchar(20)    ENCODE lzo,
	mapped_bar_custno    varchar(20)    ENCODE lzo,
	org_bar_product      varchar(22)    ENCODE lzo,
	mapped_bar_product   varchar(22)    ENCODE lzo,
	org_bar_brand        varchar(22)    ENCODE lzo,
	mapped_bar_brand     varchar(22)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	postdate             date    ENCODE az64,
	posting_week_enddate date    ENCODE RAW,
	fiscal_month_id      integer    ENCODE az64,
	bar_amt              decimal(38,8)    ENCODE az64,
	quantity             decimal(38,8)    ENCODE az64,
	quanunit             varchar(10)    ENCODE lzo,
	org_dataprocessing_hash varchar(40)    ENCODE lzo,
	mapped_dataprocessing_hash varchar(40)    ENCODE lzo,
	audit_loadts         timestamp    ENCODE az64
 ) DISTKEY (material) SORTKEY (posting_week_enddate) DISTSTYLE KEY;

CREATE TABLE stage.currency_exchange_rate ( 
	yearmonthid          integer  NOT NULL  ENCODE az64,
	fromcurrencycode     varchar(10)  NOT NULL  ENCODE lzo,
	tocurrencycode       varchar(10)  NOT NULL  ENCODE lzo,
	rate                 decimal(12,6)  NOT NULL  ENCODE az64
 )   DISTSTYLE ALL;

CREATE TABLE stage.deployment_testing ( 
	deployment_id        integer DEFAULT "identity" NOT NULL  ENCODE az64,
	deployment_date      timestamp    ENCODE lzo
 )   DISTSTYLE ALL;

CREATE TABLE stage.deployment_testing2 ( 
	range_start_date     date    ENCODE az64,
	range_end_date       date    ENCODE az64,
	shiptocust           varchar(256)    ENCODE lzo,
	soldtocust           varchar(256)    ENCODE lzo,
	bar_custno           varchar(256)    ENCODE lzo,
	material             varchar(256)    ENCODE lzo,
	bar_product          varchar(256)    ENCODE lzo,
	total_bar_amt        decimal(18,0)    ENCODE az64,
	total_bar_volume     decimal(18,0)    ENCODE az64
 ) DISTKEY (material)  DISTSTYLE KEY;

CREATE TABLE stage.marm_current_08272021 ( 
	loaddts              timestamp    ENCODE az64,
	eventdts             varchar(65535)    ENCODE lzo,
	rec_src              varchar(65535)    ENCODE lzo,
	row_sqn              bigint    ENCODE az64,
	hash_full_record     varchar(65535)    ENCODE lzo,
	headchar             varchar(65535)    ENCODE lzo,
	mandt                varchar(65535)    ENCODE lzo,
	matnr                varchar(65535)    ENCODE lzo,
	meinh                varchar(65535)    ENCODE lzo,
	umrez                decimal(38,10)    ENCODE az64,
	umren                decimal(38,10)    ENCODE az64,
	eannr                varchar(65535)    ENCODE lzo,
	ean11                varchar(65535)    ENCODE lzo,
	numtp                varchar(65535)    ENCODE lzo,
	laeng                decimal(38,10)    ENCODE az64,
	breit                decimal(38,10)    ENCODE az64,
	hoehe                decimal(38,10)    ENCODE az64,
	meabm                varchar(65535)    ENCODE lzo,
	volum                decimal(38,10)    ENCODE az64,
	voleh                varchar(65535)    ENCODE lzo,
	brgew                decimal(38,10)    ENCODE az64,
	gewei                varchar(65535)    ENCODE lzo,
	mesub                varchar(65535)    ENCODE lzo,
	atinn                decimal(38,10)    ENCODE az64,
	mesrt                decimal(38,10)    ENCODE az64,
	xfhdw                varchar(65535)    ENCODE lzo,
	xbeww                varchar(65535)    ENCODE lzo,
	kzwso                varchar(65535)    ENCODE lzo,
	msehi                varchar(65535)    ENCODE lzo,
	bflme_marm           varchar(65535)    ENCODE lzo,
	gtin_variant         varchar(65535)    ENCODE lzo,
	nest_ftr             decimal(38,10)    ENCODE az64,
	max_stack            decimal(38,10)    ENCODE az64,
	capause              decimal(38,10)    ENCODE az64,
	ty2tq                varchar(65535)    ENCODE lzo,
	zpkmatcd             varchar(65535)    ENCODE lzo,
	zpktypcd             varchar(65535)    ENCODE lzo,
	zstackf              varchar(65535)    ENCODE lzo,
	zstackwt             decimal(38,10)    ENCODE az64,
	zstkwtun             varchar(65535)    ENCODE lzo,
	tailchar             varchar(65535)    ENCODE lzo
 )   DISTSTYLE EVEN;

CREATE TABLE stage.rate_base ( 
	range_start_date     date    ENCODE az64,
	range_end_date       date    ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	bar_entity           varchar(5)    ENCODE lzo,
	soldtocust           varchar(10)    ENCODE lzo,
	bar_custno           varchar(20)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	bar_product          varchar(22)    ENCODE lzo,
	bar_currtype         varchar(6)    ENCODE lzo,
	total_bar_amt        decimal(18,0)    ENCODE az64
 ) DISTKEY (soldtocust)  DISTSTYLE KEY;

CREATE TABLE stage.rate_base_cogs ( 
	audit_rec_src        varchar(10)    ENCODE lzo,
	fiscal_month_id      integer    ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_currtype         varchar(10)    ENCODE lzo,
	soldtocust           varchar(10)    ENCODE lzo,
	shiptocust           varchar(10)    ENCODE lzo,
	bar_custno           varchar(20)    ENCODE lzo,
	material             varchar(30)    ENCODE lzo,
	bar_product          varchar(30)    ENCODE lzo,
	bar_brand            varchar(30)    ENCODE lzo,
	super_sbu            varchar(50)    ENCODE lzo,
	cost_pool            varchar(50)    ENCODE lzo,
	total_bar_amt        decimal(38,18)    ENCODE az64,
	total_bar_amt_usd    decimal(38,18)    ENCODE az64
 ) DISTKEY (material)  DISTSTYLE KEY;

CREATE TABLE stage.sgm_allocated_data_rule_09 ( 
	audit_rec_sqn        bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.sgm_allocated_data_rule_13 ( 
	audit_rec_sqn        bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.sgm_allocated_data_rule_21 ( 
	audit_rec_sqn        bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	tran_volume          decimal(38,8)    ENCODE az64,
	uom                  varchar(20)    ENCODE lzo,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.sgm_allocated_data_rule_22 ( 
	audit_rec_sqn        bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	tran_volume          decimal(38,8)    ENCODE az64,
	uom                  varchar(20)    ENCODE lzo,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.sgm_allocated_data_rule_23 ( 
	audit_rec_sqn        bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	bar_entity           varchar(7)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	rsa_reconcile_bar_custno varchar(50)    ENCODE lzo,
	rsa_reconcile_bar_division varchar(50)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	rsa_mgsv             varchar(10)    ENCODE lzo,
	rsa_pcr              varchar(300)    ENCODE lzo,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.sgm_allocated_data_rule_26 ( 
	audit_rec_sqn        bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	tran_volume          decimal(38,8)    ENCODE az64,
	uom                  varchar(20)    ENCODE lzo,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.sgm_allocated_data_rule_27 ( 
	audit_rec_sqn        bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	tran_volume          decimal(38,8)    ENCODE az64,
	uom                  varchar(20)    ENCODE lzo,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.sgm_allocated_data_rule_28 ( 
	audit_rec_sqn        bigint DEFAULT "identity" NOT NULL  ENCODE az64,
	source_system        varchar(10)    ENCODE lzo,
	org_tranagg_id       bigint    ENCODE az64,
	posting_week_enddate date  NOT NULL  ENCODE az64,
	fiscal_month_id      integer  NOT NULL  ENCODE az64,
	bar_entity           varchar(5)    ENCODE lzo,
	bar_acct             varchar(6)    ENCODE lzo,
	org_bar_brand        varchar(50)    ENCODE lzo,
	org_bar_custno       varchar(50)    ENCODE lzo,
	org_bar_product      varchar(50)    ENCODE lzo,
	mapped_bar_brand     varchar(50)    ENCODE lzo,
	mapped_bar_custno    varchar(50)    ENCODE lzo,
	mapped_bar_product   varchar(50)    ENCODE lzo,
	org_shiptocust       varchar(50)    ENCODE lzo,
	org_soldtocust       varchar(50)    ENCODE lzo,
	org_material         varchar(50)    ENCODE lzo,
	alloc_shiptocust     varchar(50)    ENCODE lzo,
	alloc_soldtocust     varchar(50)    ENCODE lzo,
	alloc_material       varchar(50)    ENCODE lzo,
	alloc_bar_product    varchar(50)    ENCODE lzo,
	bar_currtype         varchar(4)    ENCODE lzo,
	org_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	mapped_dataprocessing_ruleid integer  NOT NULL  ENCODE az64,
	dataprocessing_outcome_id integer  NOT NULL  ENCODE az64,
	dataprocessing_phase varchar(10)    ENCODE lzo,
	allocated_amt        decimal(38,8)    ENCODE az64,
	sales_volume         decimal(38,8)    ENCODE az64,
	tran_volume          decimal(38,8)    ENCODE az64,
	uom                  varchar(20)    ENCODE lzo,
	audit_loadts         date DEFAULT getdate NOT NULL  ENCODE az64
 )   DISTSTYLE AUTO;

CREATE TABLE stage.warranty_cost_allocated_amt_101_transient ( 
	fiscal_month_id      integer    ENCODE az64,
	posting_week_enddate date    ENCODE az64,
	material             varchar(50)    ENCODE lzo,
	warranty_amt         decimal(38,12)    ENCODE az64,
	invoice_sales        decimal(38,12)    ENCODE az64,
	cost_pool            varchar(50)    ENCODE lzo,
	bar_currtype         varchar(10)    ENCODE lzo,
	total_sales_bysbu    decimal(38,12)    ENCODE az64,
	avg_claim_rate       decimal(38,12)    ENCODE az64,
	allocation_rate      decimal(38,12)    ENCODE az64,
	allocated_amt        decimal(38,12)    ENCODE az64
 ) DISTKEY (material)  DISTSTYLE KEY;


